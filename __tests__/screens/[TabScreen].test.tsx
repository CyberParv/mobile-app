import React from 'react'; import { fireEvent, render } from '@testing-library/react-native'; import TabScreen from '@/app/(tabs)/index'; import { mockApi } from '../utils/test-utils'; describe('Tab Screen', () => { it('renders loading skeleton initially', () => { const { getByTestId } = render(<TabScreen />); expect(getByTestId('skeleton-loader')).toBeTruthy(); }); it('renders data after successful fetch', async () => { mockApi([{ id: 1, name: 'Item 1' }]); const { findByText } = render(<TabScreen />); expect(await findByText('Item 1')).toBeTruthy(); }); it('renders empty state when no data', async () => { mockApi([]); const { findByText } = render(<TabScreen />); expect(await findByText('No items found')).toBeTruthy(); }); it('renders error state when fetch fails', async () => { mockApi({}, 500); const { findByText } = render(<TabScreen />); expect(await findByText('Error loading data')).toBeTruthy(); }); it('pull-to-refresh triggers refetch', async () => { mockApi([{ id: 1, name: 'Item 1' }]); const { findByText, getByTestId } = render(<TabScreen />); fireEvent(getByTestId('pull-to-refresh'), 'refresh'); expect(await findByText('Item 1')).toBeTruthy(); }); it('navigation to detail screen works', () => { const { getByText } = render(<TabScreen />); fireEvent.press(getByText('Item 1')); expect(useRouter().push).toHaveBeenCalledWith('/detail/1'); }); });