import React from 'react'; import { fireEvent, render } from '@testing-library/react-native'; import TabScreen from '@/app/(tabs)/index'; import { renderWithProviders } from '../utils/test-utils'; describe('Tab Screen', () => { it('renders loading skeleton initially', () => { const { getByTestId } = renderWithProviders(<TabScreen loading={true} />); expect(getByTestId('loading-skeleton')).toBeTruthy(); }); it('renders data after successful fetch', () => { const { getByText } = renderWithProviders(<TabScreen data={[{ id: 1, name: 'Item 1' }]} />); expect(getByText('Item 1')).toBeTruthy(); }); it('renders empty state when no data', () => { const { getByText } = renderWithProviders(<TabScreen data={[]} />); expect(getByText('No items available')).toBeTruthy(); }); it('renders error state when fetch fails', () => { const { getByText } = renderWithProviders(<TabScreen error='Failed to load data' />); expect(getByText('Failed to load data')).toBeTruthy(); }); it('pull-to-refresh triggers refetch', () => { const refetch = jest.fn(); const { getByTestId } = renderWithProviders(<TabScreen refetch={refetch} />); fireEvent(getByTestId('pull-to-refresh'), 'refresh'); expect(refetch).toHaveBeenCalled(); }); it('navigation to detail screen works', () => { const { getByText } = renderWithProviders(<TabScreen data={[{ id: 1, name: 'Item 1' }]} />); fireEvent.press(getByText('Item 1')); expect(mockNavigate).toHaveBeenCalledWith('DetailScreen', { id: 1 }); }); });